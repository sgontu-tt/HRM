<% title "Leave Management" %>

<div class="row">
<div class="dropdown show-options">
  <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Show options
  <span class="caret"></span></button>
  <ul class="dropdown-menu">
    <li><%=link_to ' Apply leave', new_leave_path, :class=>"fa fa-pencil-square-o fa-fw" %></li>
    <%if @emp.role.name == "Manager"%>
    <li><%=link_to ' Team leave', leave_applied_by_team_path, :class=>"fa fa-pencil-square-o fa-fw" %></li>
    <%end%>
  </ul>
</div>
</div>

<div class="row">
<%if @emp.role.name == "HR"%>
  <div class="panel panel-cblue">
    <div class="panel-heading">Leaves applied by all employees</div>
    <div class="panel-body">

      <table class="table table-hover-color table-bordered">
        <thead>
          <tr>
            <th>ID</th>
            <th>Emp. Name</th>      
            <th>Leave type</th>
            <th>From date</th>
            <th>To date</th>
            <th>No of days</th>
            <th>Status</th>
          </tr>
        </thead>

        <tbody>
          <% @leaves.each_with_index do |leave, index| %>
            <tr>
              <td><%= index+1 %></td>
              <td><%=link_to leave.employee.fullname, leave%></td>
              <td><%=link_to Leavetype.find(leave.leavetype_id).name, leave%></td>
              <td><%=leave.fromdate.strftime('%d-%b-%Y')%></td>
              <td><%=leave.todate.strftime('%d-%b-%Y')%></td>
              <td><%=leave.no_of_days%></td>
              <td>
                <%if leave.status == true%>
                Approved
                <%else%>
                Rejected
                <%end%>
              </td>         
            </tr>
          <% end %>
        </tbody>
    </table>
    </div>
  </div>
<%end%>

<div class="panel panel-cblue">
<div class="panel-heading">Leaves waiting for approval</div>
<div class="panel-body">

<table class="table table-hover-color table-bordered">
  <thead>
    <tr>
      <th>ID</th>      
      <th>Leave type</th>
      <th>From date</th>
      <th>To date</th>
      <th>No of days</th>
      <th>Status</th>
    </tr>
  </thead>

  <tbody>
    <% @leave_waiting_for_approve.each_with_index do |leave, index| %>
      <tr>
        <td><%= index+1 %></td>
        <td><%=Leavetype.find(leave.leavetype_id).name%></td>
        <td><%=leave.fromdate.strftime('%d-%b-%Y')%></td>
        <td><%=leave.todate.strftime('%d-%b-%Y')%></td>
        <td><%=leave.no_of_days%></td>
        <td>
                <%if leave.status == true%>
                Approved
                <%elsif leave.status ==nil%>
                Waiting for approval
                <%end%>
              </td>         
      </tr>
    <% end %>
  </tbody>
</table>
</div>
</div>

<div class="panel panel-cblue">
<div class="panel-heading">Leaves applied recently</div>
<div class="panel-body">

<table class="table table-hover-color table-bordered">
  <thead>
    <tr>
      <th>ID</th>      
      <th>Leave type</th>
      <th>From date</th>
      <th>To date</th>
      <th>No of days</th>
      <th>Status</th>
    </tr>
  </thead>

  <tbody>
    <% @leave_approved.each_with_index do |leave, index| %>
      <tr>
        <td><%= index+1 %></td>
        <td><%=Leavetype.find(leave.leavetype_id).name%></td>
        <td><%=leave.fromdate.strftime('%d-%b-%Y')%></td>
        <td><%=leave.todate.strftime('%d-%b-%Y')%></td>
        <td><%=leave.no_of_days%></td>
        <td>
        <%if leave.status == true%>
          Approved
        <%end%>
        	
        </td>         
      </tr>
    <% end %>
  </tbody>
</table>
</div>
</div>
</div>